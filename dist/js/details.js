"use strict";$(".enlagemidoul").mouseenter(function(){$(".mask").css("display","block"),$(".enlagebig").css("display","block"),$(".enlagemidoul").mousemove(function(t){var i=t.pageX,e=t.pageY,n=i-$(".mask").innerWidth()/2-$(".contopenlage").position().left,a=e-$(".mask").innerHeight()/2-$(".contopenlage").position().top;n<0&&(n=0),a<0&&(a=0),n>=$(".enlagemidoul").width()-$(".mask").width()&&(n=$(".enlagemidoul").width()-$(".mask").width()),a>=$(".enlagemidoul").height()-$(".mask").height()&&(a=$(".enlagemidoul").height()-$(".mask").height()),$(".mask").css({left:n+"px",top:a+"px"}),$(".enlagebig img").css({left:4*-n+"px",top:4*-a+"px"})})}),$(".enlagemidoul").mouseleave(function(){$(".mask").css("display","none"),$(".enlagebig").css("display","none")}),$(".detailist p span").click(function(){$(this).css({border:"2px #f00 solid"}).siblings().css({border:"1px #454545 solid"})});var url=window.location.search,parentid=url.slice(url.lastIndexOf("=")+1);parentid||(parentid=-1,layer.msg("非法访问！！！",{time:800,icon:2},function(){location.href="list.html"})),$.post("http://store/src/php/detail.php",{id:parentid},function(t){var i=[];t.forEach(function(t){""!=t.shop&&i.push(t.shop)});for(var e=i.length,n=$("<ul></ul>"),a="<li>首页</li>",s=0;s<e;s++)a+="<li>"+i[s]+"</li>";a+="<li>国美服务</li>",n.html(a),$(".nav>div").append(n),$(".storecont>p:nth-child(1)>a:last-child").text(t[0].content),$(".storecont>p:nth-child(2)>span:first-child").text(t[2].content),$(".conbotStore>p:nth-child(1)>span:first-child").text(t[2].content),$(".contopdetails>h3").text(t[0].content),$(".contopdetails>p:nth-child(2)").text(t[1].content),$(".price>p>span").text(t[0].price),i=[],t.forEach(function(t){"enlage"==t.brand&&i.push(t.imgUrl)}),$(".enlagebig img").attr("src",i[0]),$(".enlagemidoul img").attr("src",i[0]),e=i.length;for(s=0;s<e;s++){var o=$("<li>\n                <img src='"+i[s]+"' alt=''>\n            </li>");$(".enlagelis ul").append(o)}$(".enlagelis ul li").mouseenter(function(){$(this).find("img").css("border-color","red").end().siblings().find("img").css("border-color","transparent"),$(".enlagebig img").attr("src",$(this).find("img").attr("src")),$(".enlagemidoul img").attr("src",$(this).find("img").attr("src"))}),$(".enlagelis ul").css("width",Math.ceil(e/5)+"00%");var l=0,r=$(".enlagelis ul").innerWidth()/$(".enlagelis").innerWidth();$(".enlageLeft").click(function(){if(--l<0)return l=0,!1;$(".enlagelis ul").animate({left:-$(".enlagelis").innerWidth()*l},800)}),$(".enlageRight").click(function(){if(r<=++l)return l=r-1,!1;$(".enlagelis ul").animate({left:-$(".enlagelis").innerWidth()*l},800)}),i=[],t.forEach(function(t){"details"==t.brand&&i.push(t.imgUrl)}),e=i.length;for(s=0;s<e;s++){var d=$("<img src='"+i[s]+"' alt=''>");$(".parameter").append(d)}},"json"),$(".detailscart>div:first-child span i").click(function(){var t=$(".detailscart>div:first-child input").val();"+"==$(this).text()&&10<++t&&(layer.msg("限购十件",{time:500}),t=10),"-"==$(this).text()&&--t<1&&(layer.msg("不能再少啦！",{time:500}),t=1),$(".detailscart>div:first-child input").val(t)}),$(".detailscart>div:first-child input").blur(function(){var t=$(".detailscart>div:first-child input").val();t<=0&&(layer.msg("最少一件",{time:500}),t=1),11<=t&&(layer.msg("限购十件",{time:500}),t=10),$(".detailscart>div:first-child input").val(t)});var coo=tool.getCookie("username");function addcart(){if(!(coo=tool.getCookie("username"))){var t=location.href;return layer.confirm("您还没有登录呢",{btn:["去登陆","算了"]},function(){localStorage.setItem("url",t),location.href="login.html"}),!0}}if($(".addcart").click(function(){if(addcart())return!1;var i=$(".detailscart>div:first-child input").val()-0,e=tool.getCookie("username");$.ajax({url:"http://store/src/php/addcart.php",data:{goodsId:parentid,username:e},dataType:"json",type:"post"}).then(function(t){t?10<i+(t.num-0)?layer.msg("超过最大限购数量,快去购物车看看吧"):$.ajax({url:"http://store/src/php/addcart.php",data:{goodsId:parentid,username:e,num:i},dataType:"json",type:"post",success:function(t){0!=t.status?layer.msg("成功添加到购物车"):layer.msg("添加失败了")}}):$.ajax({url:"http://store/src/php/addcart.php",data:{goodsId:parentid,username:e,num:i},dataType:"json",type:"post",success:function(t){0!=t.status?layer.msg("成功添加到购物车"):layer.msg("添加失败了")}})})}),window.addEventListener("scroll",function(){200<=document.documentElement.scrollTop?$(".goTop").css("display","block"):$(".goTop").css("display","none")}),$(".pay").click(function(){isLogin()}),coo){var goid=tool.getCookie("history");"undefined"!==goid?(goid=JSON.parse(goid)).forEach(function(t){if(t.user==coo){var i=0;t.id.forEach(function(t){t!=parentid&&i++}),3<=t.id.length?i==t.id.length&&(t.id.shift(),t.id.push(parentid)):i==t.id.length&&t.id.push(parentid)}}):goid=[{user:coo,id:[parentid]}],tool.setCookie("history",JSON.stringify(goid),604800)}setTimeout(function(){$.ajax({url:"http://store/src/php/readhot.php",data:{id:parentid},dataType:"json",type:"get"})},2e3);